name: Detect what files changed

on:
  workflow_call:
    inputs:
      base:
        description: 'Branch, tag, or commit SHA against which the changes will be detected'
        default: 'develop'
        required: false
        type: string
    # Map the workflow outputs to job outputs
    outputs:
      android: 
        value: ${{ jobs.files-changed.outputs.android }}
      shared:
        value: ${{ jobs.files-changed.outputs.shared }}
      ios: 
        value: ${{ jobs.files-changed.outputs.ios }}
      analytic:
        value: ${{ jobs.files-changed.outputs.analytic }}

jobs:
  files-changed:
    runs-on: ubuntu-22.04
    # Map a step output to a job output
    outputs:
      android: ${{ steps.changes.outputs.android }}
      shared: ${{ steps.changes.outputs.shared }}
      ios: ${{ steps.changes.outputs.ios }}
      analytic: ${{ steps.changes.outputs.analytic }}

    steps:
    - name: Checkout
      uses: actions/checkout@v3.6.0

    - name: Detect changes
      uses: dorny/paths-filter@v2.11.1
      id: changes
      with:
        base: ${{ inputs.base }}
        filters: .github/filters.yaml